"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.appErrorHandlerMiddleware = void 0;
const httpStatuses_1 = require("../httpStatuses");
function appErrorHandlerMiddleware(error, req, res, next) {
    if (!error.isAppError || error.report) {
        req.logger.error(error);
    }
    if (error.isAppError) {
        const { statusCode, publicMessage, code, context } = error;
        return res.status(statusCode).send({
            message: publicMessage,
            code,
            context,
            statusCode,
        });
    }
    if (process.env.NODE_ENV === 'production') {
        return res.status(httpStatuses_1.HttpStatuses.INTERNAL_SERVER_ERROR).send({
            message: 'Internal server error',
            statusCode: httpStatuses_1.HttpStatuses.INTERNAL_SERVER_ERROR,
        });
    }
    next(error);
}
exports.appErrorHandlerMiddleware = appErrorHandlerMiddleware;
//# sourceMappingURL=appErrorHandler.middleware.js.map